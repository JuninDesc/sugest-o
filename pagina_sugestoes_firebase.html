<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Sugest√µes - Firebase</title>
    <style>
        /* CSS para estiliza√ß√£o */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #1a202c; /* Azul escuro */
            color: #e2e8f0;
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: #2d3748; /* Azul um pouco mais claro */
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            flex-grow: 1;
        }

        h1 {
            color: #e53e3e; /* Vermelho */
            text-align: center;
            border-bottom: 2px solid #e53e3e;
            padding-bottom: 10px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #a0aec0;
        }

        input[type="text"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #4a5568;
            border-radius: 5px;
            background-color: #1a202c;
            color: #e2e8f0;
            font-size: 16px;
            box-sizing: border-box;
        }

        input[type="text"]:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #e53e3e;
            box-shadow: 0 0 0 3px rgba(229, 62, 62, 0.3);
        }

        button {
            width: 100%;
            padding: 15px;
            background-color: #e53e3e; /* Vermelho */
            color: white;
            border: none;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        button:hover {
            background-color: #c53030; /* Vermelho mais escuro */
        }

        button:disabled {
            background-color: #4a5568;
            cursor: not-allowed;
        }

        .action-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .clear-button {
            background-color: #4a5568;
            font-size: 14px;
            padding: 10px;
            position: relative;
        }

        .clear-button:hover {
            background-color: #2d3748;
        }

        .export-button {
            background-color: #38a169; /* Verde */
            font-size: 14px;
            padding: 10px;
            position: relative;
        }

        .export-button:hover {
            background-color: #2f855a; /* Verde mais escuro */
        }

        .protected-button::after {
            content: "üîí";
            position: absolute;
            top: 5px;
            right: 8px;
            font-size: 12px;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #a0aec0;
            margin-top: 40px;
        }

        #registros {
            margin-top: 40px;
            border-top: 1px solid #4a5568;
            padding-top: 20px;
        }

        .registros-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .registros-header h2 {
            color: #e53e3e;
            margin: 0;
        }

        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
            flex-wrap: wrap;
        }

        .contador {
            background-color: #e53e3e;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 14px;
            font-weight: bold;
        }

        .status-indicator {
            background-color: #38a169;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-indicator.offline {
            background-color: #e53e3e;
        }

        .filtro-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filtro-container label {
            margin: 0;
            font-size: 14px;
            color: #a0aec0;
            white-space: nowrap;
        }

        .filtro-container select {
            width: auto;
            min-width: 150px;
            padding: 8px 12px;
            font-size: 14px;
        }

        .sugestao-card {
            background-color: #1a202c;
            border-left: 5px solid #e53e3e;
            padding: 15px;
            margin-bottom: 15px;
            border-radius: 5px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            flex-wrap: wrap;
            position: relative;
        }

        .sugestao-card p {
            margin: 0;
            flex-basis: 100%;
            margin-bottom: 10px;
        }

        .sugestao-card .meta {
            display: flex;
            align-items: center;
            gap: 15px;
            width: 100%;
            flex-wrap: wrap;
        }
        
        .sugestao-card .nome {
            font-weight: bold;
            color: #cbd5e0;
        }

        .sugestao-card .etiqueta {
            background-color: #e53e3e;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .sugestao-card .data {
            color: #a0aec0;
            font-size: 12px;
        }

        .delete-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #e53e3e;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-button:hover {
            background-color: #c53030;
        }

        .empty-state {
            text-align: center;
            color: #a0aec0;
            padding: 40px;
            font-style: italic;
        }

        .loading-state {
            text-align: center;
            color: #4299e1;
            padding: 40px;
            font-style: italic;
        }

        .export-info {
            background-color: #1a202c;
            border: 1px solid #38a169;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            color: #68d391;
            font-size: 14px;
        }

        .security-info {
            background-color: #1a202c;
            border: 1px solid #f6ad55;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
            color: #f6ad55;
            font-size: 14px;
        }

        .firebase-info {
            background-color: #1a202c;
            border: 1px solid #4299e1;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
            color: #63b3ed;
            font-size: 14px;
        }

        .filtro-info {
            background-color: #1a202c;
            border: 1px solid #4299e1;
            border-radius: 5px;
            padding: 10px 15px;
            margin-bottom: 15px;
            color: #63b3ed;
            font-size: 14px;
            display: none;
        }

        .filtro-info.ativo {
            display: block;
        }

        /* Responsividade para dispositivos m√≥veis */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            body {
                padding: 10px;
            }

            .registros-header {
                flex-direction: column;
                align-items: stretch;
            }

            .header-controls {
                justify-content: space-between;
            }

            .action-buttons {
                grid-template-columns: 1fr;
            }

            .filtro-container {
                flex-direction: column;
                align-items: stretch;
                gap: 5px;
            }

            .filtro-container select {
                width: 100%;
                min-width: auto;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Registro R√°pido de Sugest√µes</h1>
        
        <form id="suggestionForm">
            <div class="form-group">
                <label for="sugestao">Sugest√£o / Feedback:</label>
                <textarea id="sugestao" name="sugestao" rows="4" required placeholder="Digite sua sugest√£o ou feedback aqui..."></textarea>
            </div>
            
            <div class="form-group">
                <label for="plataforma">Plataforma:</label>
                <select id="plataforma" name="plataforma" required>
                    <option value="">Selecione uma plataforma</option>
                    <option value="GCO web">GCO web</option>
                    <option value="App Android">App Android</option>
                    <option value="App iOS">App iOS</option>
                    <option value="Sistema Interno">Sistema Interno</option>
                    <option value="Portal do Aluno">Portal do Aluno</option>
                    <option value="Ambiente Virtual">Ambiente Virtual</option>
                    <option value="Outro">Outro</option>
                </select>
            </div>

            <div class="form-group">
                <label for="nome">Seu primeiro nome:</label>
                <input type="text" id="nome" name="nome" required placeholder="Digite seu primeiro nome">
            </div>
            
            <button type="submit" id="submitButton">Registrar Sugest√£o</button>
            
            <div class="action-buttons">
                <button type="button" class="clear-button protected-button" onclick="limparTodosRegistros()">üîí Limpar Todos os Registros</button>
                <button type="button" class="export-button protected-button" onclick="exportarParaExcel()">üîíüìä Exportar para Excel</button>
            </div>
        </form>

        <div class="export-info">
            <strong>üí° Dica:</strong> Use o bot√£o "Exportar para Excel" para baixar todas as sugest√µes em formato CSV, que pode ser aberto no Excel, Google Sheets ou LibreOffice Calc.
        </div>

        <div class="security-info">
            <strong>üîí Seguran√ßa:</strong> As a√ß√µes de "Limpar Todos os Registros" e "Exportar para Excel" s√£o protegidas por senha para evitar uso acidental. Apenas usu√°rios autorizados podem executar essas opera√ß√µes.
        </div>

        <div class="firebase-info">
            <strong>‚òÅÔ∏è Firebase:</strong> Agora suas sugest√µes s√£o salvas na nuvem! Os dados ficam sincronizados automaticamente entre todos os computadores e dispositivos que acessarem esta p√°gina.
        </div>

        <div id="registros">
            <div class="registros-header">
                <h2>Sugest√µes Registradas</h2>
                <div class="header-controls">
                    <div class="filtro-container">
                        <label for="filtroPlataforma">Filtrar por:</label>
                        <select id="filtroPlataforma" onchange="aplicarFiltro()">
                            <option value="">Todas as plataformas</option>
                            <option value="GCO web">GCO web</option>
                            <option value="App Android">App Android</option>
                            <option value="App iOS">App iOS</option>
                            <option value="Sistema Interno">Sistema Interno</option>
                            <option value="Portal do Aluno">Portal do Aluno</option>
                            <option value="Ambiente Virtual">Ambiente Virtual</option>
                            <option value="Outro">Outro</option>
                        </select>
                    </div>
                    <span class="status-indicator" id="statusIndicator">üîÑ Conectando...</span>
                    <span class="contador" id="contador">0 registros</span>
                </div>
            </div>
            
            <div class="filtro-info" id="filtroInfo">
                <strong>üîç Filtro ativo:</strong> Mostrando apenas sugest√µes da plataforma <span id="plataformaFiltrada"></span>
            </div>
            
            <div id="lista-registros">
                <div class="loading-state">
                    üîÑ Carregando sugest√µes do Firebase...
                </div>
            </div>
        </div>
    </div>

    <footer>
        <p>&copy; 2025 - Ferramenta de Sugest√µes Interna | Dados salvos no Firebase | Protegido por senha</p>
    </footer>

    <!-- Firebase SDKs -->
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, query, orderBy, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBMq2mLGtmzdn_7H3C6Qm_kVztDlv3E0HI",
            authDomain: "sugestoesalunos.firebaseapp.com",
            projectId: "sugestoesalunos",
            storageBucket: "sugestoesalunos.firebasestorage.app",
            messagingSenderId: "1071749368955",
            appId: "1:1071749368955:web:81a189a99ebb23dbf966de"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        // Vari√°veis globais
        const SENHA_ADMIN = '12345678GCO@';
        let filtroAtual = '';
        let todasSugestoes = [];
        let isConnected = false;

        // Fun√ß√£o para verificar senha
        function verificarSenha(acao) {
            const senha = prompt(`Para ${acao}, digite a senha de administrador:`);
            if (senha === null) {
                return false; // Usu√°rio cancelou
            }
            if (senha !== SENHA_ADMIN) {
                alert('Senha incorreta! Acesso negado.');
                return false;
            }
            return true;
        }

        // Fun√ß√£o para atualizar status de conex√£o
        function atualizarStatusConexao(conectado) {
            const statusIndicator = document.getElementById('statusIndicator');
            isConnected = conectado;
            
            if (conectado) {
                statusIndicator.textContent = '‚òÅÔ∏è Online';
                statusIndicator.classList.remove('offline');
            } else {
                statusIndicator.textContent = '‚ö†Ô∏è Offline';
                statusIndicator.classList.add('offline');
            }
        }

        // Fun√ß√£o para atualizar contador
        function atualizarContador(sugestoesFiltradas) {
            const contador = document.getElementById('contador');
            const total = sugestoesFiltradas.length;
            const totalGeral = todasSugestoes.length;
            
            if (filtroAtual) {
                contador.textContent = total === 1 ? 
                    `1 registro (de ${totalGeral} total)` : 
                    `${total} registros (de ${totalGeral} total)`;
            } else {
                contador.textContent = total === 1 ? '1 registro' : `${total} registros`;
            }
        }

        // Fun√ß√£o para aplicar filtro
        function aplicarFiltro() {
            const filtroSelect = document.getElementById('filtroPlataforma');
            filtroAtual = filtroSelect.value;
            
            const filtroInfo = document.getElementById('filtroInfo');
            const plataformaFiltrada = document.getElementById('plataformaFiltrada');
            
            if (filtroAtual) {
                filtroInfo.classList.add('ativo');
                plataformaFiltrada.textContent = filtroAtual;
            } else {
                filtroInfo.classList.remove('ativo');
            }
            
            exibirSugestoes();
        }

        // Fun√ß√£o para criar card de sugest√£o
        function criarCardSugestao(sugestao) {
            const card = document.createElement('div');
            card.classList.add('sugestao-card');
            card.dataset.id = sugestao.id;
            card.dataset.plataforma = sugestao.plataforma;

            const textoP = document.createElement('p');
            textoP.textContent = sugestao.texto;

            const metaDiv = document.createElement('div');
            metaDiv.classList.add('meta');

            const nomeSpan = document.createElement('span');
            nomeSpan.classList.add('nome');
            nomeSpan.textContent = `Sugerido por: ${sugestao.nome}`;

            const etiquetaSpan = document.createElement('span');
            etiquetaSpan.classList.add('etiqueta');
            etiquetaSpan.textContent = sugestao.plataforma;

            const dataSpan = document.createElement('span');
            dataSpan.classList.add('data');
            dataSpan.textContent = sugestao.data;

            // Bot√£o de deletar
            const deleteButton = document.createElement('button');
            deleteButton.classList.add('delete-button');
            deleteButton.innerHTML = '√ó';
            deleteButton.title = 'Remover esta sugest√£o';
            deleteButton.onclick = () => removerSugestao(sugestao.id);

            metaDiv.appendChild(nomeSpan);
            metaDiv.appendChild(etiquetaSpan);
            metaDiv.appendChild(dataSpan);
            card.appendChild(textoP);
            card.appendChild(metaDiv);
            card.appendChild(deleteButton);

            return card;
        }

        // Fun√ß√£o para exibir todas as sugest√µes (com filtro aplicado)
        function exibirSugestoes() {
            const listaRegistros = document.getElementById('lista-registros');
            
            // Aplicar filtro se necess√°rio
            let sugestoesFiltradas = todasSugestoes;
            if (filtroAtual) {
                sugestoesFiltradas = todasSugestoes.filter(s => s.plataforma === filtroAtual);
            }
            
            // Limpar lista atual
            listaRegistros.innerHTML = '';

            if (sugestoesFiltradas.length === 0) {
                const emptyState = document.createElement('div');
                emptyState.classList.add('empty-state');
                
                if (filtroAtual) {
                    emptyState.textContent = `Nenhuma sugest√£o encontrada para a plataforma "${filtroAtual}".`;
                } else {
                    emptyState.textContent = 'Nenhuma sugest√£o registrada ainda. Seja o primeiro a contribuir!';
                }
                
                listaRegistros.appendChild(emptyState);
            } else {
                // Ordenar por data (mais recente primeiro)
                sugestoesFiltradas.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
                
                sugestoesFiltradas.forEach(sugestao => {
                    const card = criarCardSugestao(sugestao);
                    listaRegistros.appendChild(card);
                });
            }

            atualizarContador(sugestoesFiltradas);
        }

        // Fun√ß√£o para carregar sugest√µes do Firebase
        async function carregarSugestoes() {
            try {
                const q = query(collection(db, 'sugestoes'), orderBy('timestamp', 'desc'));
                
                // Usar onSnapshot para atualiza√ß√µes em tempo real
                onSnapshot(q, (querySnapshot) => {
                    todasSugestoes = [];
                    querySnapshot.forEach((doc) => {
                        const data = doc.data();
                        todasSugestoes.push({
                            id: doc.id,
                            ...data
                        });
                    });
                    
                    exibirSugestoes();
                    atualizarStatusConexao(true);
                }, (error) => {
                    console.error('Erro ao carregar sugest√µes:', error);
                    atualizarStatusConexao(false);
                });
                
            } catch (error) {
                console.error('Erro ao configurar listener:', error);
                atualizarStatusConexao(false);
            }
        }

        // Fun√ß√£o para adicionar nova sugest√£o
        async function adicionarSugestao(texto, plataforma, nome) {
            const submitButton = document.getElementById('submitButton');
            const originalText = submitButton.textContent;
            
            try {
                submitButton.disabled = true;
                submitButton.textContent = 'Salvando...';
                
                const agora = new Date();
                
                const novaSugestao = {
                    texto: texto,
                    plataforma: plataforma,
                    nome: nome,
                    timestamp: agora.toISOString(),
                    data: agora.toLocaleDateString('pt-BR') + ' √†s ' + agora.toLocaleTimeString('pt-BR', {hour: '2-digit', minute: '2-digit'})
                };

                await addDoc(collection(db, 'sugestoes'), novaSugestao);
                
                // Feedback visual de sucesso
                submitButton.textContent = 'Registrado com sucesso!';
                submitButton.style.backgroundColor = '#38a169';
                
                setTimeout(() => {
                    submitButton.textContent = originalText;
                    submitButton.style.backgroundColor = '#e53e3e';
                    submitButton.disabled = false;
                }, 2000);
                
            } catch (error) {
                console.error('Erro ao adicionar sugest√£o:', error);
                alert('Erro ao salvar sugest√£o. Verifique sua conex√£o com a internet.');
                
                submitButton.textContent = originalText;
                submitButton.disabled = false;
            }
        }

        // Fun√ß√£o para remover sugest√£o
        async function removerSugestao(id) {
            if (confirm('Tem certeza que deseja remover esta sugest√£o?')) {
                try {
                    await deleteDoc(doc(db, 'sugestoes', id));
                } catch (error) {
                    console.error('Erro ao remover sugest√£o:', error);
                    alert('Erro ao remover sugest√£o. Verifique sua conex√£o com a internet.');
                }
            }
        }

        // Fun√ß√£o para limpar todos os registros (protegida por senha)
        async function limparTodosRegistros() {
            if (!verificarSenha('limpar todos os registros')) {
                return;
            }
            
            if (confirm('Tem certeza que deseja limpar TODOS os registros? Esta a√ß√£o n√£o pode ser desfeita.')) {
                try {
                    const button = document.querySelector('.clear-button');
                    const originalText = button.innerHTML;
                    button.innerHTML = 'üîÑ Limpando...';
                    button.disabled = true;
                    
                    // Buscar todos os documentos
                    const querySnapshot = await getDocs(collection(db, 'sugestoes'));
                    
                    // Deletar cada documento
                    const deletePromises = [];
                    querySnapshot.forEach((document) => {
                        deletePromises.push(deleteDoc(doc(db, 'sugestoes', document.id)));
                    });
                    
                    await Promise.all(deletePromises);
                    
                    // Resetar filtro
                    document.getElementById('filtroPlataforma').value = '';
                    filtroAtual = '';
                    document.getElementById('filtroInfo').classList.remove('ativo');
                    
                    // Feedback visual
                    button.innerHTML = '‚úÖ Todos os registros foram limpos!';
                    button.style.backgroundColor = '#38a169';
                    
                    setTimeout(() => {
                        button.innerHTML = originalText;
                        button.style.backgroundColor = '#4a5568';
                        button.disabled = false;
                    }, 3000);
                    
                } catch (error) {
                    console.error('Erro ao limpar registros:', error);
                    alert('Erro ao limpar registros. Verifique sua conex√£o com a internet.');
                    
                    const button = document.querySelector('.clear-button');
                    button.innerHTML = 'üîí Limpar Todos os Registros';
                    button.disabled = false;
                }
            }
        }

        // Fun√ß√£o para escapar caracteres especiais no CSV
        function escaparCSV(texto) {
            if (typeof texto !== 'string') {
                texto = String(texto);
            }
            // Se cont√©m v√≠rgula, aspas ou quebra de linha, envolver em aspas
            if (texto.includes(',') || texto.includes('"') || texto.includes('\n') || texto.includes('\r')) {
                // Escapar aspas duplicando-as
                texto = texto.replace(/"/g, '""');
                return `"${texto}"`;
            }
            return texto;
        }

        // Fun√ß√£o para exportar dados para Excel (CSV) - protegida por senha
        function exportarParaExcel() {
            if (!verificarSenha('exportar dados para Excel')) {
                return;
            }
            
            // Usar sugest√µes filtradas se houver filtro ativo
            let sugestoesParaExportar = todasSugestoes;
            if (filtroAtual) {
                sugestoesParaExportar = todasSugestoes.filter(s => s.plataforma === filtroAtual);
            }
            
            if (sugestoesParaExportar.length === 0) {
                const mensagem = filtroAtual ? 
                    `N√£o h√° sugest√µes da plataforma "${filtroAtual}" para exportar!` :
                    'N√£o h√° sugest√µes para exportar!';
                alert(mensagem);
                return;
            }

            // Cabe√ßalho do CSV
            const cabecalho = ['Data/Hora', 'Nome', 'Plataforma', 'Sugest√£o/Feedback'];
            
            // Converter dados para formato CSV
            const linhas = [cabecalho.join(',')];
            
            // Ordenar por data (mais antiga primeiro para o Excel)
            const sugestoesOrdenadas = [...sugestoesParaExportar].sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
            
            sugestoesOrdenadas.forEach(sugestao => {
                const linha = [
                    escaparCSV(sugestao.data),
                    escaparCSV(sugestao.nome),
                    escaparCSV(sugestao.plataforma),
                    escaparCSV(sugestao.texto)
                ];
                linhas.push(linha.join(','));
            });

            // Criar conte√∫do CSV
            const csvContent = '\uFEFF' + linhas.join('\n'); // \uFEFF √© o BOM para UTF-8
            
            // Criar blob e fazer download
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                
                // Nome do arquivo com data atual e filtro se aplic√°vel
                const agora = new Date();
                const dataFormatada = agora.toISOString().split('T')[0]; // YYYY-MM-DD
                const sufixoFiltro = filtroAtual ? `_${filtroAtual.replace(/\s+/g, '_')}` : '';
                link.setAttribute('download', `sugestoes_${dataFormatada}${sufixoFiltro}.csv`);
                
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                
                // Feedback visual
                const button = document.querySelector('.export-button');
                const originalText = button.innerHTML;
                const mensagemSucesso = filtroAtual ? 
                    `‚úÖ ${sugestoesParaExportar.length} registros de "${filtroAtual}" exportados!` :
                    '‚úÖ Exportado com sucesso!';
                
                button.innerHTML = mensagemSucesso;
                button.style.backgroundColor = '#2f855a';
                
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.style.backgroundColor = '#38a169';
                }, 3000);
            } else {
                alert('Seu navegador n√£o suporta download autom√°tico. Por favor, use um navegador mais recente.');
            }
        }

        // Tornar fun√ß√µes globais para uso nos event handlers
        window.aplicarFiltro = aplicarFiltro;
        window.limparTodosRegistros = limparTodosRegistros;
        window.exportarParaExcel = exportarParaExcel;
        window.removerSugestao = removerSugestao;

        // Event listener para o formul√°rio
        document.getElementById('suggestionForm').addEventListener('submit', function(event) {
            event.preventDefault();

            const sugestaoTexto = document.getElementById('sugestao').value.trim();
            const plataforma = document.getElementById('plataforma').value;
            const nome = document.getElementById('nome').value.trim();

            if (!sugestaoTexto || !plataforma || !nome) {
                alert('Por favor, preencha todos os campos!');
                return;
            }

            // Adicionar nova sugest√£o
            adicionarSugestao(sugestaoTexto, plataforma, nome);

            // Limpar formul√°rio
            document.getElementById('suggestionForm').reset();
            document.getElementById('sugestao').focus();
        });

        // Permitir envio com Ctrl+Enter no textarea
        document.getElementById('sugestao').addEventListener('keydown', function(event) {
            if (event.key === 'Enter' && event.ctrlKey) {
                event.preventDefault();
                document.getElementById('suggestionForm').dispatchEvent(new Event('submit'));
            }
        });

        // Carregar sugest√µes quando a p√°gina for carregada
        document.addEventListener('DOMContentLoaded', function() {
            carregarSugestoes();
            document.getElementById('sugestao').focus();
        });
    </script>

</body>
</html>

